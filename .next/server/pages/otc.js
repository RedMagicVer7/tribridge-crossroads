"use strict";(()=>{var e={};e.id=525,e.ids=[525,888,660],e.modules={8179:(e,s,t)=>{t.r(s),t.d(s,{config:()=>A,default:()=>T,getServerSideProps:()=>k,getStaticPaths:()=>_,getStaticProps:()=>P,reportWebVitals:()=>O,routeModule:()=>L,unstable_getServerProps:()=>I,unstable_getServerSideProps:()=>U,unstable_getStaticParams:()=>F,unstable_getStaticPaths:()=>Z,unstable_getStaticProps:()=>q});var a={};t.r(a),t.d(a,{default:()=>otc});var r=t(7093),i=t(5244),n=t(1323),l=t(8676),c=t.n(l),d=t(341),x=t(997),m=t(6689),o=t(8479),u=t(3012),p=t(2644),h=t(9986),j=t(1306),g=t(6982),y=t(993),f=t(1110),v=t(9455),N=t(9560),b=t(5077),C=t(9589),S=t(116),D=t(5097),w=t(3065);let TransactionForm=({order:e,onCreateTransaction:s,paymentMethods:t})=>{let[a,r]=(0,m.useState)(""),[i,n]=(0,m.useState)("");return(0,x.jsxs)("form",{onSubmit:t=>{t.preventDefault();let r=parseFloat(a);r>=e.minAmount&&r<=e.maxAmount&&i&&s(e,r,i)},className:"space-y-4",children:[(0,x.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,x.jsxs)(o.Zb,{children:[x.jsx(o.Ol,{children:x.jsx(o.ll,{className:"text-lg",children:"订单信息"})}),(0,x.jsxs)(o.aY,{className:"space-y-3",children:[(0,x.jsxs)("div",{className:"flex justify-between",children:[x.jsx("span",{children:"价格:"}),(0,x.jsxs)("span",{className:"font-medium",children:["\xa5",e.price.toFixed(2)]})]}),(0,x.jsxs)("div",{className:"flex justify-between",children:[x.jsx("span",{children:"限额:"}),(0,x.jsxs)("span",{children:["\xa5",e.minAmount.toLocaleString()," - \xa5",e.maxAmount.toLocaleString()]})]}),(0,x.jsxs)("div",{className:"flex justify-between",children:[x.jsx("span",{children:"时限:"}),(0,x.jsxs)("span",{children:[e.timeLimit,"分钟"]})]})]})]}),(0,x.jsxs)(o.Zb,{children:[x.jsx(o.Ol,{children:x.jsx(o.ll,{className:"text-lg",children:"交易详情"})}),(0,x.jsxs)(o.aY,{className:"space-y-3",children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)(j._,{children:["交易金额 (",e.fiatCurrency,")"]}),x.jsx(h.I,{type:"number",value:a,onChange:e=>r(e.target.value),placeholder:`最小 ${e.minAmount}`,min:e.minAmount,max:e.maxAmount}),a&&(0,x.jsxs)("div",{className:"text-sm text-muted-foreground mt-1",children:["将获得: ",(parseFloat(a)/e.price).toFixed(6)," ",e.cryptoCurrency]})]}),(0,x.jsxs)("div",{children:[x.jsx(j._,{children:"支付方式"}),(0,x.jsxs)(g.Ph,{value:i,onValueChange:n,children:[x.jsx(g.i4,{children:x.jsx(g.ki,{placeholder:"选择支付方式"})}),x.jsx(g.Bw,{children:t.map(e=>(0,x.jsxs)(g.Ql,{value:e.id,children:[e.icon," ",e.name]},e.id))})]})]})]})]})]}),x.jsx(u.z,{type:"submit",className:"w-full",disabled:!a||!i,children:"创建交易"})]})},TransactionChat=({transaction:e,onSendMessage:s})=>{var t;let[a,r]=(0,m.useState)(""),handleSendMessage=()=>{a.trim()&&(s(a),r(""))};return(0,x.jsxs)("div",{className:"space-y-4",children:[x.jsx(o.Zb,{children:(0,x.jsxs)(o.aY,{className:"p-4",children:[(0,x.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,x.jsxs)("div",{children:[(0,x.jsxs)("h3",{className:"font-medium",children:["交易 #",e.id]}),(0,x.jsxs)("p",{className:"text-sm text-muted-foreground",children:["\xa5",e.fiatAmount.toLocaleString()," → ",e.cryptoAmount.toFixed(6)," ",e.price>10?"USDT":"BTC"]})]}),(t=e.status,(0,x.jsxs)(p.C,{variant:{completed:"default",pending:"secondary",failed:"destructive",cancelled:"outline",paid:"secondary",released:"default"}[t]||"outline",className:"flex items-center space-x-1",children:[(e=>{switch(e){case"completed":case"released":return x.jsx(C.Z,{className:"h-4 w-4 text-success"});case"pending":default:return x.jsx(b.Z,{className:"h-4 w-4 text-warning"});case"failed":return x.jsx(S.Z,{className:"h-4 w-4 text-destructive"});case"cancelled":return x.jsx(S.Z,{className:"h-4 w-4 text-muted-foreground"});case"paid":return x.jsx(C.Z,{className:"h-4 w-4 text-warning"})}})(t),x.jsx("span",{children:{completed:"已完成",pending:"处理中",failed:"失败",cancelled:"已取消",paid:"已付款",released:"已放币"}[t]||t})]}))]}),(0,x.jsxs)("div",{className:"grid grid-cols-3 gap-4 text-center",children:[(0,x.jsxs)("div",{className:`p-3 rounded-lg ${"pending"===e.status?"bg-primary/10 text-primary":"bg-muted"}`,children:[x.jsx("div",{className:"text-sm font-medium",children:"1. 确认订单"}),x.jsx(C.Z,{className:"w-4 h-4 mx-auto mt-1"})]}),(0,x.jsxs)("div",{className:`p-3 rounded-lg ${"paid"===e.status?"bg-primary/10 text-primary":"bg-muted"}`,children:[x.jsx("div",{className:"text-sm font-medium",children:"2. 付款确认"}),x.jsx(b.Z,{className:"w-4 h-4 mx-auto mt-1"})]}),(0,x.jsxs)("div",{className:`p-3 rounded-lg ${"released"===e.status?"bg-primary/10 text-primary":"bg-muted"}`,children:[x.jsx("div",{className:"text-sm font-medium",children:"3. 放币完成"}),x.jsx(v.Z,{className:"w-4 h-4 mx-auto mt-1"})]})]})]})}),(0,x.jsxs)(o.Zb,{children:[x.jsx(o.Ol,{children:(0,x.jsxs)(o.ll,{className:"text-lg flex items-center",children:[x.jsx(D.Z,{className:"w-5 h-5 mr-2"}),"交易沟通"]})}),(0,x.jsxs)(o.aY,{children:[x.jsx("div",{className:"space-y-3 mb-4 max-h-64 overflow-y-auto",children:e.chatMessages.map(e=>x.jsx("div",{className:`flex ${"currentUser"===e.senderId?"justify-end":"justify-start"}`,children:(0,x.jsxs)("div",{className:`max-w-xs px-3 py-2 rounded-lg ${"system"===e.type?"bg-muted text-muted-foreground text-center":"currentUser"===e.senderId?"bg-primary text-primary-foreground":"bg-muted"}`,children:[x.jsx("p",{className:"text-sm",children:e.message}),x.jsx("p",{className:"text-xs opacity-70 mt-1",children:new Date(e.timestamp).toLocaleTimeString()})]})},e.id))}),(0,x.jsxs)("div",{className:"flex space-x-2",children:[x.jsx(h.I,{placeholder:"输入消息...",value:a,onChange:e=>r(e.target.value),onKeyPress:e=>"Enter"===e.key&&handleSendMessage()}),x.jsx(u.z,{onClick:handleSendMessage,children:"发送"})]})]})]}),(0,x.jsxs)("div",{className:"flex space-x-2",children:["pending"===e.status&&x.jsx(u.z,{className:"flex-1",children:"确认付款"}),"paid"===e.status&&"currentUser"===e.sellerId&&(0,x.jsxs)(u.z,{className:"flex-1",children:["放币 (释放码: ",e.releaseCode,")"]}),(0,x.jsxs)(u.z,{variant:"outline",className:"flex-1",children:[x.jsx(S.Z,{className:"w-4 h-4 mr-2"}),"申请仲裁"]})]})]})},OTC_OTCTrading=()=>{let[e,s]=(0,m.useState)({fiat:"CNY",crypto:"USDT"}),[t,a]=(0,m.useState)({buy:[],sell:[]}),[r,i]=(0,m.useState)(!1),[n,l]=(0,m.useState)(!1),[c,d]=(0,m.useState)(null),[h,C]=(0,m.useState)(null),[S,D]=(0,m.useState)(""),[T,P]=(0,m.useState)(!1),{toast:_}=(0,w.pm)(),k={fiat:[{code:"CNY",name:"人民币",flag:"\uD83C\uDDE8\uD83C\uDDF3"},{code:"RUB",name:"俄罗斯卢布",flag:"\uD83C\uDDF7\uD83C\uDDFA"},{code:"USD",name:"美元",flag:"\uD83C\uDDFA\uD83C\uDDF8"}],crypto:[{code:"USDT",name:"Tether USD"},{code:"USDC",name:"USD Coin"}]},A={CNY:[{id:"alipay",name:"支付宝",icon:"\uD83D\uDCB0"},{id:"wechat",name:"微信支付",icon:"\uD83D\uDC9A"},{id:"bank_transfer",name:"银行转账",icon:"\uD83C\uDFE6"}],RUB:[{id:"sberbank",name:"Сбербанк",icon:"\uD83C\uDFE6"},{id:"vtb",name:"ВТБ",icon:"\uD83C\uDFE6"},{id:"yoomoney",name:"ЮMoney",icon:"\uD83D\uDCB3"},{id:"qiwi",name:"QIWI",icon:"\uD83D\uDD36"}],USD:[{id:"bank_transfer",name:"Wire Transfer",icon:"\uD83C\uDFE6"},{id:"paypal",name:"PayPal",icon:"\uD83D\uDC99"}]};(0,m.useEffect)(()=>{loadOrderBook()},[e]);let loadOrderBook=async()=>{try{P(!0);let s={buy:[{id:"OTC001",userId:"user1",type:"buy",fiatCurrency:e.fiat,cryptoCurrency:e.crypto,fiatAmount:1e4,cryptoAmount:1366.12,price:"CNY"===e.fiat?7.32:96.8,minAmount:500,maxAmount:1e4,paymentMethods:"CNY"===e.fiat?["alipay","wechat"]:["sberbank","yoomoney"],timeLimit:15,status:"active",merchantRating:4.8,completedOrders:1250,remarks:"CNY"===e.fiat?"秒放币，支持支付宝、微信":"Быстрая покупка USDT",trustLevel:"verified"}],sell:[{id:"OTC002",userId:"user2",type:"sell",fiatCurrency:e.fiat,cryptoCurrency:e.crypto,fiatAmount:2e4,cryptoAmount:2732.24,price:"CNY"===e.fiat?7.32:96.8,minAmount:1e3,maxAmount:2e4,paymentMethods:"CNY"===e.fiat?["alipay","bank_transfer"]:["sberbank","vtb"],timeLimit:20,status:"active",merchantRating:4.9,completedOrders:2100,remarks:"CNY"===e.fiat?"大额交易优先，实时放币":"Крупные сделки приветствуются",trustLevel:"premium"}]};a(s)}catch(e){_({title:"加载失败",description:"无法加载订单簿数据",variant:"destructive"})}finally{P(!1)}},handleOrderClick=e=>{d(e),l(!0)},createTransaction=async(e,s,t)=>{try{let a={id:`TXN${Date.now()}`,orderId:e.id,buyerId:"buy"===e.type?e.userId:"currentUser",sellerId:"sell"===e.type?e.userId:"currentUser",fiatAmount:s,cryptoAmount:s/e.price,price:e.price,paymentMethod:t,status:"pending",chatMessages:[{id:"msg1",senderId:"system",message:"交易已创建，请按照流程进行交易",timestamp:new Date().toISOString(),type:"system"}],releaseCode:"ABC123",startTime:new Date().toISOString(),expiryTime:new Date(Date.now()+6e4*e.timeLimit).toISOString()};C(a),_({title:"交易创建成功",description:"请按照交易流程完成支付"})}catch(e){_({title:"创建交易失败",description:"请稍后重试",variant:"destructive"})}},getTrustLevelBadge=e=>{let s={verified:{variant:"default",icon:x.jsx(v.Z,{className:"w-3 h-3"}),text:"已认证"},premium:{variant:"secondary",icon:x.jsx(N.Z,{className:"w-3 h-3"}),text:"高级"},standard:{variant:"outline",icon:null,text:"标准"}},t=s[e]||s.standard;return(0,x.jsxs)(p.C,{variant:t.variant,className:"text-xs",children:[t.icon,t.text]})},renderOrderCard=e=>x.jsx(o.Zb,{className:"cursor-pointer hover:shadow-md transition-shadow",children:(0,x.jsxs)(o.aY,{className:"p-4",children:[(0,x.jsxs)("div",{className:"flex justify-between items-start mb-3",children:[(0,x.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,x.jsxs)("div",{className:"text-sm font-medium",children:["buy"===e.type?"收购":"出售"," ",e.cryptoCurrency]}),getTrustLevelBadge(e.trustLevel)]}),(0,x.jsxs)("div",{className:"text-right",children:[(0,x.jsxs)("div",{className:"text-lg font-bold text-primary",children:["\xa5",e.price.toFixed(2)]}),x.jsx("div",{className:"text-xs text-muted-foreground",children:"单价"})]})]}),(0,x.jsxs)("div",{className:"space-y-2 mb-3",children:[(0,x.jsxs)("div",{className:"flex justify-between text-sm",children:[x.jsx("span",{className:"text-muted-foreground",children:"限额:"}),(0,x.jsxs)("span",{children:["\xa5",e.minAmount.toLocaleString()," - \xa5",e.maxAmount.toLocaleString()]})]}),(0,x.jsxs)("div",{className:"flex justify-between text-sm",children:[x.jsx("span",{className:"text-muted-foreground",children:"支付方式:"}),(0,x.jsxs)("div",{className:"flex space-x-1",children:[e.paymentMethods.slice(0,2).map(s=>{let t=A[e.fiatCurrency]?.find(e=>e.id===s);return t?(0,x.jsxs)("span",{className:"text-xs px-1 py-0.5 bg-muted rounded",children:[t.icon," ",t.name]},s):null}),e.paymentMethods.length>2&&(0,x.jsxs)("span",{className:"text-xs text-muted-foreground",children:["+",e.paymentMethods.length-2]})]})]})]}),(0,x.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,x.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[x.jsx(N.Z,{className:"w-4 h-4 fill-yellow-400 text-yellow-400"}),x.jsx("span",{children:e.merchantRating.toFixed(1)}),(0,x.jsxs)("span",{className:"text-muted-foreground",children:["(",e.completedOrders,"笔)"]})]}),(0,x.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-muted-foreground",children:[x.jsx(b.Z,{className:"w-3 h-3"}),(0,x.jsxs)("span",{children:[e.timeLimit,"分钟"]})]})]}),e.remarks&&x.jsx("div",{className:"text-xs text-muted-foreground mb-3 line-clamp-2",children:e.remarks}),x.jsx(u.z,{onClick:()=>handleOrderClick(e),className:"w-full",variant:"buy"===e.type?"default":"secondary",children:"buy"===e.type?"出售给商家":"从商家购买"})]})},e.id);return(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)(o.Zb,{children:[(0,x.jsxs)(o.Ol,{children:[x.jsx(o.ll,{children:"OTC场外交易"}),x.jsx(o.SZ,{children:"安全便捷的点对点加密货币交易"})]}),x.jsx(o.aY,{children:(0,x.jsxs)("div",{className:"flex space-x-4",children:[(0,x.jsxs)("div",{className:"space-y-2",children:[x.jsx(j._,{children:"法币"}),(0,x.jsxs)(g.Ph,{value:e.fiat,onValueChange:e=>s(s=>({...s,fiat:e})),children:[x.jsx(g.i4,{className:"w-32",children:x.jsx(g.ki,{})}),x.jsx(g.Bw,{children:k.fiat.map(e=>(0,x.jsxs)(g.Ql,{value:e.code,children:[e.flag," ",e.code]},e.code))})]})]}),(0,x.jsxs)("div",{className:"space-y-2",children:[x.jsx(j._,{children:"加密货币"}),(0,x.jsxs)(g.Ph,{value:e.crypto,onValueChange:e=>s(s=>({...s,crypto:e})),children:[x.jsx(g.i4,{className:"w-32",children:x.jsx(g.ki,{})}),x.jsx(g.Bw,{children:k.crypto.map(e=>x.jsx(g.Ql,{value:e.code,children:e.code},e.code))})]})]}),x.jsx("div",{className:"flex items-end",children:x.jsx(u.z,{onClick:()=>i(!0),children:"发布广告"})})]})})]}),(0,x.jsxs)(y.mQ,{defaultValue:"sell",className:"space-y-4",children:[(0,x.jsxs)(y.dr,{className:"grid w-full grid-cols-2",children:[(0,x.jsxs)(y.SP,{value:"sell",children:["购买 ",e.crypto]}),(0,x.jsxs)(y.SP,{value:"buy",children:["出售 ",e.crypto]})]}),x.jsx(y.nU,{value:"sell",className:"space-y-4",children:T?x.jsx("div",{className:"text-center py-8",children:"加载中..."}):t.sell.length>0?x.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:t.sell.map(renderOrderCard)}):x.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"暂无出售订单"})}),x.jsx(y.nU,{value:"buy",className:"space-y-4",children:T?x.jsx("div",{className:"text-center py-8",children:"加载中..."}):t.buy.length>0?x.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:t.buy.map(renderOrderCard)}):x.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"暂无收购订单"})})]}),x.jsx(f.Vq,{open:n,onOpenChange:l,children:(0,x.jsxs)(f.cZ,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,x.jsxs)(f.fK,{children:[x.jsx(f.$N,{children:"P2P交易"}),x.jsx(f.Be,{children:c&&`与商家进行 ${c.cryptoCurrency} 交易`})]}),c&&!h&&x.jsx(TransactionForm,{order:c,onCreateTransaction:createTransaction,paymentMethods:A[c.fiatCurrency]||[]}),h&&x.jsx(TransactionChat,{transaction:h,onSendMessage:D})]})})]})},otc=()=>x.jsx("div",{className:"container mx-auto py-6",children:(0,x.jsxs)("div",{className:"space-y-6",children:[(0,x.jsxs)("div",{children:[x.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"OTC场外交易"}),x.jsx("p",{className:"text-muted-foreground",children:"安全便捷的点对点加密货币交易平台，支持多种支付方式和法币"})]}),x.jsx(OTC_OTCTrading,{})]})}),T=(0,n.l)(a,"default"),P=(0,n.l)(a,"getStaticProps"),_=(0,n.l)(a,"getStaticPaths"),k=(0,n.l)(a,"getServerSideProps"),A=(0,n.l)(a,"config"),O=(0,n.l)(a,"reportWebVitals"),q=(0,n.l)(a,"unstable_getStaticProps"),Z=(0,n.l)(a,"unstable_getStaticPaths"),F=(0,n.l)(a,"unstable_getStaticParams"),I=(0,n.l)(a,"unstable_getServerProps"),U=(0,n.l)(a,"unstable_getServerSideProps"),L=new r.PagesRouteModule({definition:{kind:i.x.PAGES,page:"/otc",pathname:"/otc",bundlePath:"",filename:""},components:{App:d.default,Document:c()},userland:a})},3363:e=>{e.exports=require("@radix-ui/react-dialog")},8367:e=>{e.exports=require("@radix-ui/react-label")},4034:e=>{e.exports=require("@radix-ui/react-select")},2324:e=>{e.exports=require("@radix-ui/react-slot")},5665:e=>{e.exports=require("@radix-ui/react-tabs")},2479:e=>{e.exports=require("@radix-ui/react-toast")},999:e=>{e.exports=require("@radix-ui/react-tooltip")},8910:e=>{e.exports=require("@tanstack/react-query")},1169:e=>{e.exports=require("class-variance-authority")},8103:e=>{e.exports=require("clsx")},1162:e=>{e.exports=require("next-themes")},4580:e=>{e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},2785:e=>{e.exports=require("next/dist/compiled/next-server/pages.runtime.prod.js")},6689:e=>{e.exports=require("react")},997:e=>{e.exports=require("react/jsx-runtime")},1399:e=>{e.exports=require("sonner")},5873:e=>{e.exports=require("tailwind-merge")},1017:e=>{e.exports=require("path")}};var s=require("../webpack-runtime.js");s.C(e);var __webpack_exec__=e=>s(s.s=e),t=s.X(0,[614,769,676,450,538,364,116,341,479,644,941,777,110],()=>__webpack_exec__(8179));module.exports=t})();