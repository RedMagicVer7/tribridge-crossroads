# 快速入门

<cite>
**本文档引用的文件**
- [README.md](file://README.md)
- [DEPLOYMENT_GUIDE.md](file://DEPLOYMENT_GUIDE.md)
- [docker-compose.yml](file://docker-compose.yml)
- [package.json](file://package.json)
- [backend/package.json](file://backend/package.json)
- [start-demo.sh](file://start-demo.sh)
- [start-system.sh](file://start-system.sh)
- [backend/src/index.ts](file://backend/src/index.ts)
- [backend/src/services/database.ts](file://backend/src/services/database.ts)
- [backend/src/services/redis.ts](file://backend/src/services/redis.ts)
</cite>

## 目录
1. [简介](#简介)
2. [开发环境准备](#开发环境准备)
3. [依赖安装](#依赖安装)
4. [环境变量配置](#环境变量配置)
5. [数据库初始化](#数据库初始化)
6. [服务启动流程](#服务启动流程)
7. [验证部署成功](#验证部署成功)
8. [常见问题解决方案](#常见问题解决方案)
9. [总结](#总结)

## 简介
本指南旨在帮助新开发者在本地环境中快速部署和运行tribridge-crossroads全栈应用。通过逐步说明，您将在30分钟内完成从环境准备到服务启动的全过程，为后续开发和测试奠定基础。

## 开发环境准备
在开始部署之前，请确保您的开发环境满足以下要求：

- **Node.js**: 版本18或更高
- **Docker**: 用于容器化部署
- **pnpm**: 包管理工具（也可使用npm）

### 检查Node.js版本
```bash
node --version
```

### 安装Docker
请访问[Docker官网](https://www.docker.com/)下载并安装适合您操作系统的Docker Desktop。

### 安装pnpm
```bash
npm install -g pnpm
```

**Section sources**
- [README.md](file://README.md#L26-L32)

## 依赖安装
本项目分为前端和后端两个部分，需要分别安装依赖。

### 前端依赖安装
```bash
cd 
npm install
```

### 后端依赖安装
```bash
cd backend
npm install
```

**Section sources**
- [README.md](file://README.md#L35-L44)

## 环境变量配置
创建必要的环境变量文件以配置应用。

### 创建前端环境变量文件
在项目根目录创建`.env`文件：
```bash
touch .env
```

添加以下内容：
```env
# 前端环境变量
VITE_API_URL=http://localhost:8000
VITE_APP_NAME=TriBridge
VITE_APP_VERSION=1.0.0
VITE_ENVIRONMENT=development
```

### 创建后端环境变量文件
在`backend`目录下创建`.env`文件：
```bash
cd backend && touch .env
```

添加以下内容：
```env
# 后端环境变量
PORT=8000
NODE_ENV=development
DATABASE_URL=postgresql://tribridge:password@localhost:5432/tribridge
REDIS_URL=redis://localhost:6379
JWT_SECRET=your-jwt-secret-key
```

**Section sources**
- [DEPLOYMENT_GUIDE.md](file://DEPLOYMENT_GUIDE.md#L58-L84)

## 数据库初始化
使用Docker启动PostgreSQL和Redis容器。

### 启动数据库容器
```bash
docker-compose up -d postgres redis
```

### 验证容器状态
```bash
docker ps
```

您应该能看到`postgres`和`redis`容器正在运行。

**Section sources**
- [docker-compose.yml](file://docker-compose.yml#L20-L54)

## 服务启动流程
有多种方式可以启动服务，推荐使用提供的脚本。

### 方法一：使用启动脚本（推荐）
```bash
# 返回项目根目录
cd 

# 赋予脚本执行权限
chmod +x start-demo.sh

# 运行启动脚本
./start-demo.sh
```

### 方法二：使用Docker Compose
```bash
docker-compose up --build
```

### 方法三：手动启动
```bash
# 在一个终端中启动后端
cd backend
npm run build
npm start

# 在另一个终端中启动前端
cd ..
npm run dev
```

**Section sources**
- [start-demo.sh](file://start-demo.sh)
- [docker-compose.yml](file://docker-compose.yml)

## 验证部署成功
完成部署后，通过以下步骤验证系统是否正常运行。

### 访问前端界面
打开浏览器并访问：
```
http://localhost:3000
```
您应该能看到TriBridge的前端界面。

### 调用健康检查API
```bash
curl http://localhost:8000/health
```

预期返回：
```json
{
  "status": "healthy",
  "timestamp": "2024-01-01T00:00:00.000Z",
  "version": "1.0.0",
  "environment": "development"
}
```

### 检查API文档
访问API文档以了解可用端点：
```
http://localhost:8000/api/docs
```

**Section sources**
- [backend/src/index.ts](file://backend/src/index.ts#L165-L177)
- [README.md](file://README.md#L68-L71)

## 常见问题解决方案
### 端口冲突
如果遇到端口被占用的问题：

```bash
# 检查端口占用情况
lsof -i :3000
lsof -i :8000

# 终止占用端口的进程
kill -9 $(lsof -t -i:3000)
kill -9 $(lsof -t -i:8000)
```

### 依赖安装失败
```bash
# 清理缓存后重试
npm cache clean --force
rm -rf node_modules package-lock.json
npm install
```

### 环境变量缺失
确保所有必需的环境变量都已正确设置，特别是：
- `VITE_API_URL`（前端）
- `DATABASE_URL`（后端）
- `JWT_SECRET`（后端）

### 数据库连接问题
```bash
# 检查数据库服务状态
docker logs postgres

# 重新启动数据库容器
docker-compose restart postgres
```

**Section sources**
- [start-demo.sh](file://start-demo.sh#L17-L28)
- [backend/src/services/database.ts](file://backend/src/services/database.ts#L100-L130)
- [backend/src/services/redis.ts](file://backend/src/services/redis.ts#L50-L80)

## 总结
通过以上步骤，您已经成功在本地环境中部署了tribridge-crossroads全栈应用。现在您可以开始进行开发和测试工作。记住定期查看日志文件以监控系统状态，并在遇到问题时参考本指南的故障排除部分。